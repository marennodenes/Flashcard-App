@startuml create_flashcard_deck_sequence
!theme plain
skinparam monochrome true
skinparam shadowing false



/' 

- user writes deck name and clicks on "New Deck" button
- (FlashcardMainController) whenNewDeckButtonIsClicked(ActionEvent): 
    - (ApiClient) performApiRequest(String, String, Object, TupeReference<T>): 
        -sendRequest(): returnerer <--  validates, 
        <--parseResponse(String, TypeReference): <-- OBJECT_MAPPER.readValue(json, typeReference)
    - (ApiResponse) isSuccess() <-- boolean

    - loadUserData()
        (ApiEndpoints) getUserDecksUrl(String username)
        (DeckController) createDeck(username, deck)
        isSucess and getData hvis disse stemmer sÃ¥
            - 
    - updateUi()
        setText(String), setVisible(), 
        hideAllDeckButtons


 '/


actor "App User" as User
participant "FlashcardMainController" as MainController
participant "REST API Client" as APIClient
participant "API Response" as ApiResponse
participant "API Endpoints" as ApiEndpoints
participant "DeckController" as DeckController
participant "DeckController" as DeckController
participant "FlashcardDeckMapper" as FlashcardDeckMapper
participant "FlashcardDeckDto" as FlashcardDeckDto


User -> MainController : clicks "Create New Deck"
activate MainController

/' MainController -> User : displays deck creation form
User -> MainController : enters deck name and details '/
/' MainController -> MainController : validates input '/

MainController -> APIClient : whenNewDeckButtonIsClicked(ActionEvent)
activate APIClient

APIClient -> APIClient : performApiRequest()

APIClient -> ApiResponse : 
activate ServerUserController

ServerUserController -> FlashcardService : whenNewDeckButtonIsClicked(ActionEvent)
activate FlashcardService

FlashcardService -> Core : create FlashcardDeck object
activate Core
Core -> Core : validate deck data
Core --> FlashcardService : return FlashcardDeck
deactivate Core

FlashcardService -> Storage : saveDeck(flashcardDeck)
activate Storage
Storage -> Storage : serialize to JSON
Storage --> FlashcardService : confirmation
deactivate Storage

FlashcardService --> ServerUserController : return success response
deactivate FlashcardService

ServerUserController --> APIClient : HTTP 201 Created
deactivate ServerUserController

APIClient --> MainController : deck created successfully
deactivate APIClient

MainController -> User : displays success message
MainController -> User : navigates to deck view
deactivate MainController

@enduml